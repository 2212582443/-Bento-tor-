{"name": "monitor", "code": "\nimport psutil\nimport datetime\nimport time\n\ndef monitor():\n    # CPU\u7684\u903b\u8f91\u6838\u6570\n    cpu_count = psutil.cpu_count()\n    # cpu\u7684\u4f7f\u7528\u7387\n    cup_per = psutil.cpu_percent(interval=0.5) # 0.5\u5237\u65b0\u9891\u7387\n    final=f\"cpu\u7684\u903b\u8f91\u6838\u6570\u4e3a{cpu_count},cpu\u7684\u5e73\u5747\u4f7f\u7528\u7387\u4e3a{cup_per}\n\"\n    # \u5185\u5b58\u4fe1\u606f\n    memory_info = psutil.virtual_memory()\n    # \u603b\u5185\u5b58\n    memory_total = memory_info.total / 1024 / 1024\n    # \u5185\u5b58\u4f7f\u7528\u7387\n    #memory_per = (memory_total - memory_info.available) / memory_total * 100\n    memory_per = memory_info.percent\n    final=final+f\"\u603b\u5185\u5b58\u5927\u5c0f\u4e3a{memory_total}M,\u5185\u5b58\u7684\u4f7f\u7528\u7387\u4e3a{memory_per}\n\"\n    # \u786c\u76d8\u4fe1\u606f\n    disk_info = psutil.disk_usage(\"/\") # \u6839\u76ee\u5f55\u78c1\u76d8\u4fe1\u606f\n    # \u6839\u76ee\u5f55\u5927\u5c0f\n    disk_total = disk_info.total\n    # \u6839\u76ee\u5f55\u4f7f\u7528\u60c5\u51b5\n    disk_per = float(disk_info.used / disk_total * 100 )\n    final=final+f\"\u6839\u76ee\u5f55\u5927\u5c0f\u4e3a{disk_total / 1024 / 1024}M,\u6839\u76ee\u5f55\u4f7f\u7528\u7387\u4e3a{round(disk_per,2)}\n\"\n    # \u7f51\u7edc\u4f7f\u7528\u60c5\u51b5\n    net = psutil.net_io_counters()\n    #print(net)\n    # \u7f51\u5361\u914d\u7f6e\u4fe1\u606f\n    net_ipy = psutil.net_if_addrs()\n    #print(f\"net_ipy {net_ipy}\")\n    net_ip = net_ipy['virbr0'][0][1]\n    final=final+f\"\u672c\u673a\u7684IP\u5730\u5740\u4e3a{net_ip}\n\"\n    # \u6536\u53d6\u6570\u636e\n    net_recv = float( net.bytes_recv / 1024 /1024)\n    # \u53d1\u9001\u6570\u636e\n    net_sent = float(net.bytes_sent /1024 /1024)\n    final=final+f\"\u7f51\u7edc\u6536\u53d6{round(net_recv,2)}M\u7684\u6570\u636e,\u53d1\u9001{round(net_sent,2)}M\u7684\u6570\u636e\n\"\n    # \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\n    current_time = datetime.datetime.now().strftime(\"%F %T\") # %F\u5e74\u6708\u65e5 %T\u65f6\u5206\u79d2\n    final=final+f\"\u5f53\u524d\u65f6\u95f4\u662f\uff1a{current_time}\n\"\n    time.sleep(1)\n    api.send(final)\n        \n    "}